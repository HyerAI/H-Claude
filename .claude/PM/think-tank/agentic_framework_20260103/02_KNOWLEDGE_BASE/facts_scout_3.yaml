meta:
  scout_id: 3
  focus_area: 'Templates & prompts'
  problem: 'How should we update H-Claude to implement the Agentic Framework (PO, ORCA, RCH, ARC, WR, QA, VA agents)?'
  collected: '2026-01-03'

facts:
  # Template Structure & Organization
  - id: F3-001
    source: '.claude/templates/:glob'
    type: code
    content: 'Templates organized into 4 main folders: think-tank/, hc-plan/, red-team/, hc-execute/'
    confidence: HIGH
    relevance: HIGH
    tags: [structure, organization]

  - id: F3-002
    source: '.claude/templates/template-prompts/:glob'
    type: code
    content: 'template-prompts/ contains 4 command-specific subfolders: think-tank/, red-team/, hc-glass/, hc-execute/'
    confidence: HIGH
    relevance: HIGH
    tags: [structure, organization]

  - id: F3-003
    source: '.claude/templates/template-prompts/think-tank/:glob'
    type: code
    content: 'think-tank has 18+ prompt templates including: scout_facts.md, council_domain_expert.md, council_pragmatist.md, synthesizer_consensus.md, validator.md, generator_adr.md, generator_spec.md, generator_execution_plan.md, merge_facts.md, arbiter_conflict.md, fact_validator.md'
    confidence: HIGH
    relevance: HIGH
    tags: [templates, think-tank]

  - id: F3-004
    source: '.claude/templates/template-prompts/hc-execute/:glob'
    type: code
    content: 'hc-execute has 6 prompt templates: orchestrator.md, oraca_phase.md, worker_task.md, qa_phase.md, synthesizer_qa.md, sweeper.md'
    confidence: HIGH
    relevance: HIGH
    tags: [templates, hc-execute]

  # Variable Substitution Pattern
  - id: F3-005
    source: '.claude/templates/template-prompts/think-tank/scout_facts.md:2'
    type: code
    content: 'Template variables use {{VARIABLE_NAME}} syntax (double curly braces)'
    confidence: HIGH
    relevance: HIGH
    tags: [syntax, variables]

  - id: F3-006
    source: '.claude/templates/template-prompts/think-tank/scout_facts.md:1-4'
    type: code
    content: 'Template header format includes: # Title, # Variables: {{VAR1}}, {{VAR2}}, # Model: Flash/Pro/Opus (port), # Purpose: description'
    confidence: HIGH
    relevance: HIGH
    tags: [syntax, header, metadata]

  - id: F3-007
    source: '.claude/templates/template-prompts/think-tank/scout_facts.md:2'
    type: code
    content: 'scout_facts.md variables: {{SESSION_PATH}}, {{PROBLEM}}, {{FOCUS_AREA}}, {{SCOUT_ID}}, {{TIMESTAMP}}'
    confidence: HIGH
    relevance: HIGH
    tags: [variables, scout]

  - id: F3-008
    source: '.claude/templates/template-prompts/think-tank/generator_execution_plan.md:2'
    type: code
    content: 'generator_execution_plan.md variables: {{SESSION_PATH}}, {{DECIDED_PATH}}, {{CONFIDENCE}}, {{PLAN_LEVEL}}, {{TIMESTAMP}}'
    confidence: HIGH
    relevance: HIGH
    tags: [variables, generator]

  - id: F3-009
    source: '.claude/templates/template-prompts/hc-execute/worker_task.md:2'
    type: code
    content: 'worker_task.md variables: {{SESSION_PATH}}, {{PHASE_NUM}}, {{TASK_ID}}, {{TASK_DESCRIPTION}}, {{SUCCESS_CRITERIA}}, {{FILES}}, {{RELEVANT_INTERFACES}}'
    confidence: HIGH
    relevance: HIGH
    tags: [variables, worker]

  - id: F3-010
    source: '.claude/templates/template-prompts/hc-execute/oraca_phase.md:2'
    type: code
    content: 'oraca_phase.md variables: {{SESSION_PATH}}, {{PHASE_NUM}}, {{PHASE_TASKS}}, {{RELEVANT_INTERFACES}}, {{WORKSPACE}}'
    confidence: HIGH
    relevance: HIGH
    tags: [variables, oraca]

  - id: F3-011
    source: '.claude/templates/template-prompts/hc-execute/orchestrator.md:2'
    type: code
    content: 'hc-execute orchestrator.md variables: {{PLAN_PATH}}, {{MODE}}, {{WORKSPACE}}'
    confidence: HIGH
    relevance: HIGH
    tags: [variables, orchestrator]

  # Model Assignment Pattern
  - id: F3-012
    source: '.claude/templates/template-prompts/think-tank/scout_facts.md:3'
    type: code
    content: 'Scout agents use Flash model (port 2405)'
    confidence: HIGH
    relevance: HIGH
    tags: [model, scout]

  - id: F3-013
    source: '.claude/templates/template-prompts/think-tank/generator_execution_plan.md:3'
    type: code
    content: 'Generator agents use Pro model (port 2406)'
    confidence: HIGH
    relevance: HIGH
    tags: [model, generator]

  - id: F3-014
    source: '.claude/templates/template-prompts/think-tank/council_domain_expert.md:3'
    type: code
    content: 'Domain Expert council agent uses Opus model (port 2408)'
    confidence: HIGH
    relevance: HIGH
    tags: [model, council]

  - id: F3-015
    source: '.claude/templates/template-prompts/hc-execute/orchestrator.md:3'
    type: code
    content: 'hc-execute orchestrator uses Opus model (port 2408)'
    confidence: HIGH
    relevance: HIGH
    tags: [model, orchestrator]

  - id: F3-016
    source: '.claude/templates/template-prompts/hc-execute/worker_task.md:3'
    type: code
    content: 'Worker task agents use Flash model (port 2405)'
    confidence: HIGH
    relevance: HIGH
    tags: [model, worker]

  # Prompt Structure Pattern
  - id: F3-017
    source: '.claude/templates/template-prompts/think-tank/scout_facts.md:6-16'
    type: code
    content: 'Prompts define agent identity first ("You are a..."), then mission/context, then rules, then output format with exact file path'
    confidence: HIGH
    relevance: HIGH
    tags: [structure, prompt-pattern]

  - id: F3-018
    source: '.claude/templates/template-prompts/think-tank/scout_facts.md:29-57'
    type: code
    content: 'Output format is embedded as YAML or Markdown schema within the prompt, showing exact structure agent should produce'
    confidence: HIGH
    relevance: HIGH
    tags: [output, schema]

  - id: F3-019
    source: '.claude/templates/template-prompts/hc-execute/worker_task.md:17-19'
    type: code
    content: 'Worker prompts specify exact output path using template variables: {{SESSION_PATH}}/PHASE_{{PHASE_NUM}}/WORKER_OUTPUTS/TASK_{{TASK_ID}}_EVIDENCE.md'
    confidence: HIGH
    relevance: HIGH
    tags: [output, path-pattern]

  - id: F3-020
    source: '.claude/templates/template-prompts/think-tank/council_domain_expert.md:22-24'
    type: code
    content: 'Council prompts specify reading order: BRIEFING.md first, then BRIEFING_PACK.md, then SUMMARY_LATEST.md, then current session'
    confidence: HIGH
    relevance: HIGH
    tags: [context, reading-order]

  # Template Output Patterns
  - id: F3-021
    source: '.claude/templates/template-prompts/think-tank/scout_facts.md:31'
    type: code
    content: 'Scout outputs structured YAML with meta, facts[], gaps[] sections'
    confidence: HIGH
    relevance: HIGH
    tags: [output, yaml]

  - id: F3-022
    source: '.claude/templates/template-prompts/think-tank/generator_execution_plan.md:39-90'
    type: code
    content: 'Execution plan outputs YAML with meta, phases[].tasks[] structure including trace_req, definition_of_done, target_context, dependencies per task'
    confidence: HIGH
    relevance: HIGH
    tags: [output, execution-plan]

  - id: F3-023
    source: '.claude/templates/template-prompts/think-tank/validator.md:22-36'
    type: code
    content: 'Validator outputs structured verdict (APPROVED/NOT_APPROVED), FEEDBACK_ITEMS with Category/Severity/Suggestion, and RATIONALE'
    confidence: HIGH
    relevance: HIGH
    tags: [output, validation]

  - id: F3-024
    source: '.claude/templates/template-prompts/think-tank/synthesizer_consensus.md:24-52'
    type: code
    content: 'Consensus synthesizer outputs CONSENSUS_MUST_FIX (3-4 validators agree), TIEBREAKER_NEEDED (2 agree), NO_CONSENSUS (1 only - ignored)'
    confidence: HIGH
    relevance: HIGH
    tags: [output, consensus]

  # Agent Role Patterns
  - id: F3-025
    source: '.claude/templates/template-prompts/think-tank/council_domain_expert.md:17-20'
    type: code
    content: 'Council agents use collaboration signals: "Yes, and..." to build, "Yes, but..." to add nuance, "AGREED: [point]" to acknowledge, "RESEARCH_REQUEST:" to ask for more info'
    confidence: HIGH
    relevance: HIGH
    tags: [signals, council]

  - id: F3-026
    source: '.claude/templates/template-prompts/think-tank/validator.md:13-19'
    type: code
    content: 'Validators check: Completeness (all constraints addressed), Logical Soundness (trade-offs accurate), Blind Spots (missed considerations), Accuracy (claims supported), Actionability (user can decide)'
    confidence: HIGH
    relevance: HIGH
    tags: [criteria, validation]

  - id: F3-027
    source: '.claude/templates/template-prompts/think-tank/merge_facts.md:18-23'
    type: code
    content: 'Merge agent: combines facts, deduplicates, flags conflicts for arbiter, never resolves conflicts itself'
    confidence: HIGH
    relevance: HIGH
    tags: [role, merge]

  - id: F3-028
    source: '.claude/templates/template-prompts/think-tank/arbiter_conflict.md:14-17'
    type: code
    content: 'Arbiter agent: investigates conflicts by going to sources, verifies which fact is accurate, resolves with evidence only (no opinions)'
    confidence: HIGH
    relevance: HIGH
    tags: [role, arbiter]

  # Template Schemas
  - id: F3-029
    source: '.claude/templates/think-tank/EXECUTION_PLAN_SCHEMA.md'
    type: doc
    content: 'Execution plan schema defines: topic, created, last_updated, status (draft|review|approved|in_progress|complete), decision{path,version,confidence}, phases[]{id,name,status,tasks[]}, execution{started,completed,session_path}, reviews[]'
    confidence: HIGH
    relevance: HIGH
    tags: [schema, execution-plan]

  - id: F3-030
    source: '.claude/templates/think-tank/STATE_SCHEMA.md'
    type: doc
    content: 'STATE.yaml schema defines: topic, created, last_active, status, lifecycle{type,status,archived_date,archive_reason,pause_reason}, parent{}, escalations[], current_session{}, sessions[], decisions[], learnings[], open_questions[], cast{}, action_items[]'
    confidence: HIGH
    relevance: HIGH
    tags: [schema, state]

  - id: F3-031
    source: '.claude/templates/think-tank/STATE_SCHEMA.md:23-27'
    type: doc
    content: 'Lifecycle types: roadmap (--roadmap flag), phase (--phase=PHASE-XXX flag), side_quest (no flag), legacy (pre-V2.0.0 migration)'
    confidence: HIGH
    relevance: HIGH
    tags: [schema, lifecycle]

  # Generator Pattern
  - id: F3-032
    source: '.claude/templates/template-prompts/think-tank/generator_spec.md:1-5'
    type: code
    content: 'Generator prompts define identity as Architect role and explicit mission ("Before we plan HOW, prove we CAN")'
    confidence: HIGH
    relevance: HIGH
    tags: [generator, pattern]

  - id: F3-033
    source: '.claude/templates/template-prompts/think-tank/generator_spec.md:95-103'
    type: code
    content: 'SPEC generator outputs feasibility verdict: FEASIBLE, FEASIBLE_WITH_RISKS, or NOT_FEASIBLE (blocks execution plan)'
    confidence: HIGH
    relevance: HIGH
    tags: [generator, feasibility]

  - id: F3-034
    source: '.claude/templates/template-prompts/think-tank/generator_execution_plan.md:94-106'
    type: code
    content: 'Execution plan generator has validation checklist: every task has trace_req to NORTHSTAR, every task has definition_of_done, dependencies form valid DAG, risks from SPEC addressed'
    confidence: HIGH
    relevance: HIGH
    tags: [generator, validation]

  # Orchestrator Patterns
  - id: F3-035
    source: '.claude/templates/template-prompts/hc-execute/orchestrator.md:9-21'
    type: code
    content: 'Orchestrator mandates synchronous sub-agent spawning: capture output with $(...), check exit code, log immediately. Anti-pattern: fire-and-forget with &'
    confidence: HIGH
    relevance: HIGH
    tags: [orchestrator, spawn-pattern]

  - id: F3-036
    source: '.claude/templates/template-prompts/hc-execute/orchestrator.md:41-49'
    type: code
    content: 'Orchestrator Phase 1: Parse plan, extract phases, generate INTERFACES.md, create phase folders (PHASE_1/, PHASE_2/), log parsing'
    confidence: HIGH
    relevance: HIGH
    tags: [orchestrator, phase-1]

  - id: F3-037
    source: '.claude/templates/template-prompts/hc-execute/orchestrator.md:53-66'
    type: code
    content: 'Orchestrator Phase 2: For each phase, spawn Oraca[X] synchronously with template oraca_phase.md, wait before next phase'
    confidence: HIGH
    relevance: HIGH
    tags: [orchestrator, phase-2]

  - id: F3-038
    source: '.claude/templates/template-prompts/hc-execute/orchestrator.md:79-92'
    type: code
    content: 'Orchestrator Phase 4 (Sweep): Adversarial prior "15% of tasks will be missed", spawns sweeper.md to hunt gaps, creates fix tasks if gaps found'
    confidence: HIGH
    relevance: HIGH
    tags: [orchestrator, sweep]

  - id: F3-039
    source: '.claude/templates/template-prompts/hc-execute/oraca_phase.md:21-25'
    type: code
    content: 'Oraca execution rules: max 3 parallel workers, sync spawns only, evidence required per worker, max 2 retries before BLOCKED'
    confidence: HIGH
    relevance: HIGH
    tags: [oraca, rules]

  # Command-Template Integration
  - id: F3-040
    source: '.claude/commands/think-tank.md:7'
    type: doc
    content: 'Command frontmatter points to templates folder: templates: .claude/templates/template-prompts/think-tank/'
    confidence: HIGH
    relevance: HIGH
    tags: [command, integration]

  - id: F3-041
    source: '.claude/commands/think-tank.md:719-765'
    type: doc
    content: 'Command documents template reference table mapping templates to model (Flash/Pro/Opus) and purpose (research, council, synthesis, generation)'
    confidence: HIGH
    relevance: HIGH
    tags: [command, template-map]

  - id: F3-042
    source: '.claude/commands/think-tank.md:192-246'
    type: doc
    content: 'Fact-based research flow: 4 parallel Flash scouts (scout_facts.md) -> Flash merge (merge_facts.md) -> Flash arbiter if conflicts (arbiter_conflict.md) -> 2 Flash validators (fact_validator.md) -> final facts.yaml'
    confidence: HIGH
    relevance: HIGH
    tags: [workflow, research]

  - id: F3-043
    source: '.claude/commands/think-tank.md:139-143'
    type: doc
    content: 'Proxy configuration: Flash on port 2405, Pro on port 2406, Opus on port 2408, invoked via ANTHROPIC_API_BASE_URL=http://localhost:240X claude --dangerously-skip-permissions -p "PROMPT"'
    confidence: HIGH
    relevance: HIGH
    tags: [proxy, invocation]

gaps:
  - 'No explicit template validation mechanism found (templates are not validated before use)'
  - 'No template inheritance or composition pattern found (each template is self-contained)'
  - 'No templating engine configuration found (substitution appears to be done inline)'
  - 'No version tracking for templates themselves (only command has version in frontmatter)'
  - 'Could not find where variable substitution actually occurs in code (orchestrator just passes prompt string)'
  - 'No documentation on creating new agent templates or extending existing ones'

notes:
  - 'Templates follow consistent header format: Title, Variables, Model, Purpose'
  - 'All output paths use SESSION_PATH as root, enabling artifact isolation per session'
  - 'Model assignment appears intentional: Flash for speed (scouts, merge), Pro for reasoning (generators, validators), Opus for expertise (council, orchestrator)'
  - 'Templates embed output schemas directly rather than referencing external schema files'
  - 'Validation is done via multi-agent consensus (2-4 validators) rather than automated checks'

scout_id: 2
focus_area: 'Current CLAUDE.md structure and HC rules'

facts:
  # === HC ROLE DEFINITION ===
  - id: F2-001
    category: role_definition
    finding: 'HC role defined as "Product Owner" - guides through SSoT → Roadmap → Phases → Execution'
    source: 'CLAUDE.md:5-7'
    relevance: HIGH

  - id: F2-002
    category: role_definition
    finding: 'Global instructions define role as "Holistic System Architect & Technical Orchestrator"'
    source: '~/.claude/CLAUDE.md:1'
    relevance: HIGH

  - id: F2-003
    category: role_definition
    finding: 'HC and HeyDude (user) described as "single team" with shared project responsibility'
    source: '~/.claude/CLAUDE.md:2-4'
    relevance: HIGH

  - id: F2-004
    category: role_definition
    finding: 'HC is "HeyDudes NorthStar" - correct when wrong, guide to right decisions, prevent over-engineering'
    source: '~/.claude/CLAUDE.md:5'
    relevance: HIGH

  - id: F2-005
    category: role_definition
    finding: 'Anti-sycophancy mandate: Be direct and objective, no excessive praise, correct immediately'
    source: '~/.claude/CLAUDE.md:6'
    relevance: HIGH

  # === SESSION START PROTOCOL ===
  - id: F2-006
    category: session_protocol
    finding: 'Session start has 5 mandatory steps executed IMMEDIATELY on every new session'
    source: 'CLAUDE.md:77-125'
    relevance: HIGH

  - id: F2-007
    category: session_protocol
    finding: 'Step 1: Cleanup orphans with pkill -f "Session-Triage agent"'
    source: 'CLAUDE.md:81-85'
    relevance: MEDIUM

  - id: F2-008
    category: session_protocol
    finding: 'Step 2: Read state files - context.yaml and ROADMAP.yaml'
    source: 'CLAUDE.md:87-91'
    relevance: HIGH

  - id: F2-009
    category: session_protocol
    finding: 'Step 3: Spawn triage agent in background with 60s timeout using Bash+proxy (NOT Task tool)'
    source: 'CLAUDE.md:93-116'
    relevance: HIGH

  - id: F2-010
    category: session_protocol
    finding: 'Step 4: Greet user immediately without waiting for triage - use recent_action and objective from context'
    source: 'CLAUDE.md:118-121'
    relevance: MEDIUM

  - id: F2-011
    category: session_protocol
    finding: 'Step 5: MANDATORY retrieve triage output when user responds - never skip, ensures cleanup'
    source: 'CLAUDE.md:123-125'
    relevance: HIGH

  # === STATE MANAGEMENT ===
  - id: F2-012
    category: state_management
    finding: 'context.yaml is primary state file - read at start, update regularly during session'
    source: 'CLAUDE.md:133-134'
    relevance: HIGH

  - id: F2-013
    category: state_management
    finding: 'context.yaml structure: meta, project, roadmap path, focus, recent_actions (keep last 10), tasks, blockers, backlog, think_tank'
    source: 'CLAUDE.md:237-265'
    relevance: HIGH

  - id: F2-014
    category: state_management
    finding: 'During session: Update context.yaml after significant work, log to recent_actions'
    source: 'CLAUDE.md:218-224'
    relevance: HIGH

  - id: F2-015
    category: state_management
    finding: 'Unsorted tasks go to context.yaml backlog, tech debt to ROADMAP.yaml phase'
    source: 'CLAUDE.md:223-224'
    relevance: MEDIUM

  - id: F2-016
    category: state_management
    finding: 'End/Commit requires: update context.yaml, ROADMAP.yaml if changed, CHANGELOG.md, spawn git-engineer'
    source: 'CLAUDE.md:226-232'
    relevance: HIGH

  # === GIT INTEGRATION ===
  - id: F2-017
    category: git_integration
    finding: 'git-engineer agent handles commits - analyzes changes, crafts Conventional Commit message'
    source: 'CLAUDE.md:294-302'
    relevance: HIGH

  - id: F2-018
    category: git_integration
    finding: 'git-engineer ALWAYS includes context.yaml in commits for crash-proof state'
    source: 'CLAUDE.md:300'
    relevance: HIGH

  - id: F2-019
    category: git_integration
    finding: 'git-engineer follows protocols in .claude/PM/GIT/PROTOCOLS.md'
    source: 'CLAUDE.md:301'
    relevance: MEDIUM

  - id: F2-020
    category: git_integration
    finding: 'Global: GIT COMMIT = work log, not just version control. Use commit messages to document.'
    source: '~/.claude/CLAUDE.md:41'
    relevance: HIGH

  # === PROXY RULES ===
  - id: F2-021
    category: proxy_rules
    finding: 'Task tool DOES NOT WORK for custom agents - must use Bash+proxy instead'
    source: 'CLAUDE.md:31'
    relevance: HIGH

  - id: F2-022
    category: proxy_rules
    finding: 'Three proxies available: Flash (2405) for code, Pro (2406) for reasoning/QA, Claude (2408) for complex'
    source: 'CLAUDE.md:165-176'
    relevance: HIGH

  - id: F2-023
    category: proxy_rules
    finding: 'Global reinforces: DO NOT USE Task Tool for Sub-Agents, USE ONLY THESE PROXIES'
    source: '~/.claude/CLAUDE.md:76-77'
    relevance: HIGH

  - id: F2-024
    category: proxy_rules
    finding: 'ALWAYS USE Flash Agent to Write Code'
    source: '~/.claude/CLAUDE.md:80'
    relevance: HIGH

  - id: F2-025
    category: proxy_rules
    finding: 'Always spawn agent in project WORKSPACE pwd to avoid access issues'
    source: 'CLAUDE.md:34, ~/.claude/CLAUDE.md:78'
    relevance: MEDIUM

  # === RESOURCE SAFETY ===
  - id: F2-026
    category: resource_safety
    finding: 'Every run_in_background MUST have matching TaskOutput(block: true) - never fire-and-forget'
    source: 'CLAUDE.md:305-319'
    relevance: HIGH

  - id: F2-027
    category: resource_safety
    finding: 'Pre-flight checks mandatory: df -h / before Docker/builds, >80% = STOP'
    source: 'CLAUDE.md:51, ~/.claude/CLAUDE.md:139-143'
    relevance: HIGH

  - id: F2-028
    category: resource_safety
    finding: '10 Golden Rules of Resource Safety defined based on 2025-11-15 disk exhaustion incident'
    source: '~/.claude/CLAUDE.md:121-185'
    relevance: HIGH

  # === CORE PRINCIPLES ===
  - id: F2-029
    category: principles
    finding: 'KISS, YAGNI, DRY, SoC, SSoT are core principles - defined in both project and global'
    source: 'CLAUDE.md:17-26, ~/.claude/CLAUDE.md:49-58'
    relevance: HIGH

  - id: F2-030
    category: principles
    finding: 'SSoT structure: NORTHSTAR.md (WHAT) vs ROADMAP.yaml (HOW) - must stay aligned'
    source: 'CLAUDE.md:9-14'
    relevance: HIGH

  - id: F2-031
    category: principles
    finding: 'NORTHSTAR guides all work - validate solutions against it'
    source: 'CLAUDE.md:325'
    relevance: HIGH

  # === BEHAVIORAL RULES ===
  - id: F2-032
    category: behavioral
    finding: 'Critical rules repeated with !!! emphasis: No assumptions, ask if unclear, no unrequested work'
    source: '~/.claude/CLAUDE.md:10-16, 207-211'
    relevance: HIGH

  - id: F2-033
    category: behavioral
    finding: 'Fix issues directly - DO NOT create workarounds'
    source: 'CLAUDE.md:72, ~/.claude/CLAUDE.md:207'
    relevance: HIGH

  - id: F2-034
    category: behavioral
    finding: 'Research in folder BEFORE asking HeyDude - self-serve first'
    source: '~/.claude/CLAUDE.md:8'
    relevance: MEDIUM

  - id: F2-035
    category: behavioral
    finding: 'Use Decision Brief format when surfacing decisions that need user input'
    source: 'CLAUDE.md:57-66, ~/.claude/CLAUDE.md:188-204'
    relevance: HIGH

  # === DOCUMENTATION ===
  - id: F2-036
    category: documentation
    finding: 'CHANGELOG.md must be updated after every commit - <20 words per entry, Keep a Changelog format'
    source: 'CLAUDE.md:38-45, ~/.claude/CLAUDE.md:91-118'
    relevance: HIGH

  - id: F2-037
    category: documentation
    finding: 'ADRs for architectural decisions - template in PM/SSoT/ADRs/'
    source: 'CLAUDE.md:222'
    relevance: MEDIUM

  - id: F2-038
    category: documentation
    finding: 'TEMP folder (.claude/PM/TEMP/) for drafts and temp files - keep Production Folder clean'
    source: '~/.claude/CLAUDE.md:29'
    relevance: MEDIUM

  # === AGENT ROLES ===
  - id: F2-039
    category: agent_roles
    finding: 'Six main roles defined: ORCA (Opus), RCH (Flash), ARC (Pro), WR (Flash), QA (Pro), VA (Flash)'
    source: 'CLAUDE.md:179-187'
    relevance: HIGH

  - id: F2-040
    category: agent_roles
    finding: 'Gauntlet roles from ADR-002: Writer (Opus), Critic (Pro), Arbiter (Flash)'
    source: 'CLAUDE.md:189-195'
    relevance: MEDIUM

gaps:
  - 'No explicit "HC Discipline" section - rules scattered across both CLAUDE.md files'
  - 'No formal definition of when HC should pause vs continue autonomously'
  - 'No explicit error recovery protocol when state files are corrupted/missing'
  - 'Session triage agent prompt is embedded in CLAUDE.md, not in agents/ folder'
  - 'No metrics or success criteria for session management discipline'
  - 'Decision Brief format differs slightly between global and project CLAUDE.md (global has "Why I Cant Decide" field)'
  - 'No explicit rule about when to spawn sub-agents vs handle directly'
  - 'Conflict: Project says "Product Owner", Global says "System Architect" - role ambiguity'
  - 'No definition of "significant work" that triggers context.yaml update'
  - 'No validation rules for context.yaml structure integrity'
  - 'recent_actions "keep last 10" has no enforcement mechanism'
  - 'think_tank status transitions (active→paused→decided→archived) undocumented'

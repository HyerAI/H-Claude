# Execution Plan: HC System Prompt Design
# Generated: 2026-01-04
# Session: hc_system_prompt_design_20260104

meta:
  title: 'HC System Prompt Design Implementation'
  source: '.claude/PM/think-tank/hc_system_prompt_design_20260104/'
  confidence: HIGH
  status: approved

decisions:
  - HC-LOG: minimal (USER-PREFERENCES.md + HC-FAILURES.md)
  - Triage: live document (SESSION_STATUS.md)
  - CLAUDE.md: high-level process only
  - HC agents: git-engineer, session-triage, hc-scout (new)
  - Routing: 3+ files OR phase work → commands
  - Rename: HD → HC

phases:
  - id: PHASE-1
    title: 'Rename HD → HC'
    tasks:
      - id: T1.1
        title: 'Find/replace HD → HC in command files'
        files:
          - .claude/commands/think-tank.md
          - .claude/commands/hc-execute.md
          - .claude/commands/hc-glass.md
          - .claude/commands/red-team.md
        definition_of_done: 'No "HD" references in command files (except historical)'

      - id: T1.2
        title: 'Find/replace HD → HC in SSoT files'
        files:
          - .claude/PM/SSoT/AGENT_ROLES.md
          - .claude/PM/SSoT/ADRs/*.md
        definition_of_done: 'ADRs and AGENT_ROLES use HC terminology'

      - id: T1.3
        title: 'Update global CLAUDE.md'
        files:
          - ~/.claude/CLAUDE.md
        definition_of_done: 'HeyDude references kept (user name), HD → HC where referring to Claude'

  - id: PHASE-2
    title: 'Create HC-LOG Infrastructure'
    tasks:
      - id: T2.1
        title: 'Create HC-LOG folder'
        action: 'mkdir -p .claude/PM/HC-LOG'
        definition_of_done: 'Folder exists'

      - id: T2.2
        title: 'Create USER-PREFERENCES.md template'
        files:
          - .claude/PM/HC-LOG/USER-PREFERENCES.md
        content: |
          # User Preferences
          # Learned preferences from sessions. HC reads at session start.
          # Update when user explicitly states a preference.

          ## Communication
          - Prefers direct correction over diplomatic hedging
          - Wants decisions surfaced via Decision Brief format

          ## Workflow
          - Friction in validation is intentional ("friction is the feature")
          - Quality over speed - never rush planning

          ## Code Style
          - [to be populated]

          ---
          Last updated: 2026-01-04
        definition_of_done: 'Template exists with initial preferences'

      - id: T2.3
        title: 'Create HC-FAILURES.md template'
        files:
          - .claude/PM/HC-LOG/HC-FAILURES.md
        content: |
          # HC Failures Log
          # Incidents and lessons. Triage reads last 5.
          # Add entry when: command fails, workflow breaks, audit finds gaps

          ## Incident Log

          ### [2026-01-04] INIT-001: Log initialized
          - **What happened:** HC-FAILURES.md created
          - **Lesson:** Real systems fail - log it, learn from it
          - **Prevention:** This log exists

          ---
          Keep last 20 incidents. Archive older to HC-FAILURES-ARCHIVE.md
        definition_of_done: 'Template exists with schema'

  - id: PHASE-3
    title: 'Create SESSION_STATUS.md and Update Triage'
    tasks:
      - id: T3.1
        title: 'Create SESSION_STATUS.md template'
        files:
          - .claude/PM/SESSION_STATUS.md
        content: |
          # Session Status
          # Updated by session-triage agent at session start
          # HC reviews this instead of ephemeral triage output

          last_updated: null

          ## Last Session
          - [populated by triage]

          ## Roadmap Status
          - Active: [phase]
          - Next: [phase]

          ## Drift Alerts
          - [none or list]

          ## Recent Failures (from HC-FAILURES.md)
          - [last 3 incidents]

          ## Recommended Action
          - [single concrete next step]
        definition_of_done: 'Template exists'

      - id: T3.2
        title: 'Update session-triage.md to write SESSION_STATUS.md'
        files:
          - .claude/agents/session-triage.md
        changes:
          - 'Output target: .claude/PM/SESSION_STATUS.md instead of stdout'
          - 'Read HC-FAILURES.md (last 5 incidents)'
          - 'Include Recent Failures section in output'
        definition_of_done: 'Triage agent updates live document'

  - id: PHASE-4
    title: 'Create hc-scout Agent'
    tasks:
      - id: T4.1
        title: 'Create hc-scout.md agent definition'
        files:
          - .claude/agents/hc-scout.md
        content_summary: |
          - Role: Research and validation helper for HC
          - Model: Flash (2405)
          - Purpose: Save HC context by delegating quick lookups
          - Operations: find, verify, summarize, compare
          - Invocation: HC spawns via Bash+proxy for specific questions
        definition_of_done: 'Agent definition exists with clear scope'

  - id: PHASE-5
    title: 'Update CLAUDE.md with HC Discipline'
    tasks:
      - id: T5.1
        title: 'Rewrite project CLAUDE.md'
        files:
          - CLAUDE.md
        changes:
          - 'Add HC Discipline section (routing rules, no internal details)'
          - 'Add HC Support Team section (git-engineer, session-triage, hc-scout)'
          - 'Update SESSION START to include pre-flight validation'
          - 'Update SESSION START to read SESSION_STATUS.md instead of TaskOutput'
          - 'Remove detailed command internals (keep high-level what/when)'
          - 'Rename HD → HC throughout'
        definition_of_done: 'CLAUDE.md is high-level orchestrator guide, not worker manual'

      - id: T5.2
        title: 'Update global ~/.claude/CLAUDE.md'
        files:
          - ~/.claude/CLAUDE.md
        changes:
          - 'Rename HD → HC where appropriate'
          - 'Keep HeyDude (user name)'
        definition_of_done: 'Consistent HC naming'

  - id: PHASE-6
    title: 'Validation and Commit'
    tasks:
      - id: T6.1
        title: 'Verify all files created/updated'
        action: |
          ls -la .claude/PM/HC-LOG/
          ls -la .claude/PM/SESSION_STATUS.md
          ls -la .claude/agents/hc-scout.md
          grep -r "HD" .claude/commands/ | grep -v "METHOD\|THRESHOLD" | wc -l  # Should be 0
        definition_of_done: 'All artifacts exist, no stray HD references'

      - id: T6.2
        title: 'Update CHANGELOG.md'
        files:
          - .claude/PM/CHANGELOG.md
        definition_of_done: 'Version bump with changes documented'

      - id: T6.3
        title: 'Commit via git-engineer'
        action: 'Spawn git-engineer for commit'
        definition_of_done: 'Changes committed with conventional message'

execution:
  started: '2026-01-04T17:00:00Z'
  completed: '2026-01-04T18:30:00Z'
  session_path: null

risks:
  - risk: 'CLAUDE.md changes may break existing workflows'
    mitigation: 'Keep command references intact, only remove internal details'
  - risk: 'Triage updating file may cause conflicts'
    mitigation: 'Triage is read-only except for SESSION_STATUS.md'
